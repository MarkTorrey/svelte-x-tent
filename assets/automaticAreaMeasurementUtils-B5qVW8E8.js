import{l$ as et,m0 as nt,m1 as it,m2 as at,g$ as W,fn as st,ix as Z,m3 as ot,dh as lt,hh as rt,dm as ut,dd as I,m4 as P,e0 as G,m5 as ct,fm as R,m6 as j,a$ as ft,ia as _,m7 as pt,m8 as ht,fu as B,O as mt,m9 as q,ma as k,V as r,W as u,X as M,aE as dt,eq as gt,ed as N,mb as J,mc as U,md as T,me as O,mf as X,mg as y,mh as vt,mi as F,mj as $t,mk as yt,ml as kt,dq as E,mm as bt,ih as xt,je as It,di as At,dO as wt,dJ as Vt,mn as Lt,mo as Mt,mp as Ut,mq as Ft}from"./index-Cek7aMWl.js";import{n as Rt}from"./PointSnappingHint-D4hTAt-c.js";import{G as _t,M as St,_ as qt,w as H,B as $,U as Ot,H as zt,L as Ct,J as Dt,A as Pt,K as Y,l as jt}from"./Tooltip-C0zPoNsb.js";import{N as Bt}from"./MeshTransform-4dnYKNDH.js";import{i as Tt}from"./earcut-DbRqQWyy.js";import{S as Xt}from"./triangle-BHpEeeo3.js";class ye{draw(n,t){const i=Et(n),a=this.sortUniqueHints(i),o=[];for(const s of a)s instanceof et&&o.push(this.visualizeIntersectionPoint(s,t)),s instanceof nt&&o.push(this.visualizeLine(s,t)),s instanceof it&&o.push(this.visualizeParallelSign(s,t)),s instanceof at&&o.push(this.visualizeRightAngleQuad(s,t)),s instanceof Rt&&o.push(this.visualizePoint(s,t));return W(o)}sortUniqueHints(n){return n}}function Et(e){const n=[];for(const t of e){let i=!0;for(const a of n)if(t.equals(a)){i=!1;break}i&&n.push(t)}return n}function ke(e,n){const t=Z(n.vertexSpace),{scale:i,orientation:a}=e,{transform:o}=n,s=Yt(o);t&&s!=null?(a.actual=q(s,"degrees","arithmetic"),a.visible=!0):(a.actual=null,a.visible=!1),t?(i.actual=k(Q(o)),i.visible=!0):(i.actual=null,i.visible=!1)}function be(e,n,t){var b,g,A,x,v,f,D;if(!n||!Z(n.vertexSpace))return;const i=n.transform??(n.transform=new Bt),{rotationAngle:a,rotationAxis:o}=i,s=ot(e.orientation.actual),h=K(o);if(s!=null&&h!=null&&s!==a){(b=t==null?void 0:t.onRotateStart)==null||b.call(t,a);const d=s*h;i.rotationAngle=d,(g=t==null?void 0:t.onRotate)==null||g.call(t,d),(A=t==null?void 0:t.onRotateStop)==null||A.call(t,d)}const p=(x=e.scale.actual)==null?void 0:x.value,c=Q(i);if(p!=null&&p!==c){const{scale:d}=i;let m;if((v=t==null?void 0:t.onScaleStart)==null||v.call(t,d[0],d[1],d[2]),c===0)m=lt(rt);else{const tt=p/c;m=ut(I(),d,tt)}i.scale=m,(f=t==null?void 0:t.onScale)==null||f.call(t,m[0],m[1],m[2]),(D=t==null?void 0:t.onScaleStop)==null||D.call(t,m[0],m[1],m[2])}}function xe(e,n){const{x:t,y:i,z:a}=n,{x:o,y:s,z:h}=Ht(e,n.spatialReference);return{dx:o==null||R(o,t)?0:o-t,dy:s==null||R(s,i)?0:s-i,dz:h==null||a==null||R(h,a)?0:h-a}}function Ht(e,n){var o,s,h;let t,i,a;if(e.geographic){t=j(e.longitude.actual),i=j(e.latitude.actual),ft(n)&&(t!=null&&i!=null?[t,i]=_(t,i,S):t!=null?t=_(t,0,S)[0]:i!=null&&(i=_(0,i,S)[1]));const p=e.elevation.actual,c=pt(n);a=c!=null&&p!=null?ht(p,c):void 0}else t=(o=e.x.actual)==null?void 0:o.value,i=(s=e.y.actual)==null?void 0:s.value,a=(h=e.elevation.actual)==null?void 0:h.value;return{x:t,y:i,z:a}}const S=[0,0];function Yt(e){if(!e)return 0;const n=K(e.rotationAxis);return n!=null?n*e.rotationAngle:null}function K(e){return P(e,G)?1:P(e,Wt)?-1:null}const Wt=st(I(),G);function Q(e){return e?Math.max(...e.scale):1}function Ie(e,n){return!(e.type!=="key-down"||e.key!==ct.enterInputMode||!n||!Zt(n.info))&&(n.enterInputMode(),e.stopPropagation(),!0)}function Zt(e){const n=e==null?void 0:e.sketchOptions;if(!n)return!1;const{inputEnabled:t,visibleElements:i}=n.tooltips;return t&&e.editableFields.some(({name:a})=>a==="x"||a==="y"?i.coordinates:i[a])===!0}function Ae(e){let n=null;return W([e.on("paste",async t=>{n==null||n.abort(),n=B(async()=>{qt()||await H(),Gt(t,e.info)})}),B(()=>H()),mt(()=>n==null?void 0:n.abort())])}function Gt(e,n){var i;if(!n||!("geographic"in n))return;const t=(i=e.clipboardData)==null?void 0:i.getData("text");if(t)if(n.geographic){const a=_t(t);a&&(n.longitude.applyValue(a.longitude),n.latitude.applyValue(a.latitude),e.stopPropagation(),e.preventDefault())}else{const a=St(t);a&&(n.x.applyValue(a.x),n.y.applyValue(a.y),e.stopPropagation(),e.preventDefault())}}let l=class extends dt{constructor(e){super(e),this.actual=null,this.lockable=!0,this.id=gt(),this.inputValue=null,this.readOnly=!1,this.suffix=null,this.visible=!0,this.invalid=!1,this.unlockOnVertexPlacement=!0}get committed(){return this.lockable?this._get("committed"):null}set committed(e){this.lockable&&this._set("committed",e)}get dirty(){return this.inputValue!=null}get locked(){return this.lockable&&this.committed!=null}onInput(e){this.inputValue=e}onCommit(e,n,t){this.lockable?this._onCommitLockable(e,t):this._onCommitNonLockable(t),this.invalid&&e==="commit-and-exit"||t.onCommit(n,e)}_onCommitLockable(e,n){const{inputValue:t,locked:i}=this;i&&w(t)?this.unlock():(e==="commit-and-exit"&&!i||t!=null)&&this._parseInputAndLock(n)}_onCommitNonLockable(e){const{inputValue:n}=this;w(n)?this.setActual(null):n!=null&&this._parseInputAndSetActual(e)}applyValue(e){this.lockable?this.lock(e):this.setActual(e)}clearInputValue(){this.inputValue=null,this.invalid=!1}setActual(e){this.actual=e,this.clearInputValue()}lock(e){this.lockable&&(this.committed=e??this.actual,this.clearInputValue())}unlock(){this.lockable&&(this.committed=null,this.clearInputValue())}toggleLock(e){this.lockable&&(this.locked?this.unlock():this._parseInputAndLock(e))}getSuffix(e){const{suffix:n}=this;return typeof n=="function"?n(e):n}getFormattedValue(e){const{actual:n,committed:t,format:i}=this;return t!=null?i(t,e):n!=null?i(n,e):null}getRawDisplayValue(e){const{actual:n,committed:t,inputValue:i}=this;return i??(this.lockable&&t!=null?this.formatForInputMode(t,e):n!=null?this.formatForInputMode(n,e):null)}_parseInputAndSetActual(e){const{inputValue:n}=this;if(n==null||w(n))return this.setActual(null);const t=this.parse(n,e);t!=null?this.setActual(t):this.invalid=!0}_parseInputAndLock(e){const{inputValue:n,actual:t}=this;if(w(n))return this.unlock();if(n==null)return this.lock(t);const i=this.parse(n,e);i!=null?this.lock(i):this.invalid=!0}};function w(e){return e!=null&&e.trim()===""}r([u()],l.prototype,"actual",void 0),r([u()],l.prototype,"committed",null),r([u()],l.prototype,"dirty",null),r([u()],l.prototype,"format",void 0),r([u()],l.prototype,"formatForInputMode",void 0),r([u()],l.prototype,"lockable",void 0),r([u()],l.prototype,"locked",null),r([u()],l.prototype,"id",void 0),r([u()],l.prototype,"inputValue",void 0),r([u()],l.prototype,"name",void 0),r([u()],l.prototype,"parse",void 0),r([u()],l.prototype,"readOnly",void 0),r([u()],l.prototype,"suffix",void 0),r([u()],l.prototype,"title",void 0),r([u()],l.prototype,"visible",void 0),r([u()],l.prototype,"invalid",void 0),r([u()],l.prototype,"unlockOnVertexPlacement",void 0),l=r([M("esri.views.interactive.tooltip.fields.TooltipField")],l);let V=class extends l{constructor(e){super(e),this.showAsZ=!1}normalizeCtorArgs(e){const n=t=>t.inputUnitInfos.verticalLength.unit;return{name:"elevation",actual:N,parse:$((t,i)=>J(t,n(i))),format:(t,i)=>i.formatters.verticalLength(t),formatForInputMode:(t,i)=>i.formatters.scalar(U(t,n(i))),suffix:t=>t.inputUnitInfos.verticalLength.abbreviation,title:t=>t.messages.sketch[this.showAsZ?"z":"elevation"],unlockOnVertexPlacement:!1,...e}}};r([u()],V.prototype,"showAsZ",void 0),V=r([M("esri.views.interactive.tooltip.fields.TooltipFieldElevation")],V);let L=class extends l{constructor(e){super(e),this.precision=1}normalizeCtorArgs(e){const n=t=>t.inputUnitInfos.orientation.unit;return{name:"orientation",actual:null,parse:$((t,i)=>q(t,n(i),"geographic")),format:t=>{const i=T(t);return Ot(i,"geographic",this.precision)},formatForInputMode:(t,i)=>{const a=T(t);return i.formatters.scalar(a)},suffix:t=>t.inputUnitInfos.orientation.abbreviation,title:t=>t.messages.sketch.orientation,...e}}};r([u()],L.prototype,"precision",void 0),L=r([M("esri.views.interactive.tooltip.fields.TooltipFieldOrientation")],L);function we(e){const n=i=>i.inputUnitInfos.direction.unit,t=i=>i.sketchOptions.values.effectiveDirectionMode;return new l({name:"direction",actual:O,parse:$((i,a)=>q(i,n(a),"geographic")),format:(i,a)=>{const o=t(a),s=X(i,o);switch(o){case y.Absolute:return a.formatters.direction(s);case y.Relative:return a.formatters.directionRelative(s);case y.RelativeBilateral:return a.formatters.directionRelativeBilateral(s)}},formatForInputMode:(i,a)=>{const o=X(i,t(a));return a.formatters.scalar(U(o,n(a)))},suffix:i=>i.inputUnitInfos.direction.abbreviation,title:i=>{const a=t(i),{absolute:o,relative:s}=i.messages.sketch.direction;switch(a){case y.Absolute:return o;case y.Relative:case y.RelativeBilateral:return s}},...e})}function Nt(e){const n=t=>t.inputUnitInfos.length.unit;return new l({name:"distance",actual:N,parse:$((t,i)=>J(Math.max(t,0),n(i))),format:(t,i)=>i.formatters.length(t),formatForInputMode:(t,i)=>i.formatters.scalar(U(t,n(i))),suffix:t=>t.inputUnitInfos.length.abbreviation,title:t=>t.messages.sketch.distance,...e})}function Ve(){return Nt({format:(e,n)=>n.formatters.totalLength(e),title:e=>e.messages.sketch.totalLength,readOnly:!0})}function Jt(e){return new V(e)}function Le(e){return new L(e)}function Me(e){return z("scale",{name:"scale",actual:null,parse:$(n=>k(Math.abs(n))),...e})}function Ue(e){const n=t=>t.inputUnitInfos.area.unit;return new l({name:"area",actual:vt,parse:$((t,i)=>F(t,n(i))),format:(t,i)=>i.formatters.area(t),formatForInputMode:(t,i)=>i.formatters.scalar(U(t,n(i))),suffix:t=>t.inputUnitInfos.area.abbreviation,title:t=>t.messages.sketch.area,readOnly:!0,...e})}function Kt(e){return new l({name:"x",actual:O,parse:zt,format:(n,t)=>t.formatters.longitudeDecimalDegrees(n),formatForInputMode:n=>Ct(n),suffix:n=>n.inputUnitInfos.longitudeLatitude.abbreviation,title:n=>n.messages.sketch.longitude,...e})}function Qt(e){return new l({name:"y",actual:O,parse:Dt,format:(n,t)=>t.formatters.latitudeDecimalDegrees(n),formatForInputMode:n=>Pt(n),suffix:n=>n.inputUnitInfos.longitudeLatitude.abbreviation,title:n=>n.messages.sketch.latitude,...e})}function te(e){return z("x",{name:"x",...e})}function ee(e){return z("y",{name:"y",...e})}function z(e,n){return new l({actual:k(0),parse:$(t=>k(t)),format:(t,i)=>i.formatters.scalar(t),formatForInputMode:(t,i)=>i.formatters.scalar(t),title:t=>t.messages.sketch[e],...n})}const Fe=e=>{let n=class extends e{constructor(){super(...arguments),this.longitude=Kt(),this.latitude=Qt(),this.x=te(),this.y=ee(),this.elevation=Jt(),this.geographic=!1}get effectiveX(){return this.geographic?this.longitude:this.x}get effectiveY(){return this.geographic?this.latitude:this.y}get key(){return{longitude:this.longitude.actual,latitude:this.latitude.actual,x:this.x.actual,y:this.y.actual,elevation:this.elevation.actual,geographic:this.geographic}}setLocationFromPoint(t,i=t==null?void 0:t.spatialReference){if(this.geographic=!!i&&$t(i),t==null)return this._setActualLonLat(null,null),void this._setActualXY(null,null);if(this.geographic){const a=yt(t,ne);this._setActualLonLat(Y(a==null?void 0:a[0]),Y(a==null?void 0:a[1]))}else this._setActualXY(k(t.x),k(t.y))}_setActualLonLat(t,i){this.longitude.actual=t,this.latitude.actual=i}_setActualXY(t,i){this.x.actual=t,this.y.actual=i}};return r([u()],n.prototype,"geographic",void 0),r([u()],n.prototype,"effectiveX",null),r([u()],n.prototype,"effectiveY",null),r([u()],n.prototype,"key",null),n=r([M("esri.views.interactive.tooltip.infos.TooltipInfoWithCoordinates")],n),n},ne=[0,0];function ie(e,n=C()){return ae(e,n,!1)}function ae(e,n,t=e.hasZ){const i=jt(e.spatialReference),a=kt(i);if(a==null)return null;const o=(h,p)=>!(p.length<2)&&(E(h,p[0],p[1],t&&p[2]||0),!0);let s=0;for(const h of e.rings){const p=h.length;if(p<3)continue;const{positionsWorldCoords:c}=n;for(;c.length<p;)c.push(I());const b=se,g=E(oe,0,0,0),A=1/p;for(let f=0;f<p;f++){if(!o(b,h[f])||!bt(b,e.spatialReference,c[f],i))return null;xt(g,g,c[f],A)}const x=It(c[0],c[1],g,At());if(wt(Vt(x))===0)continue;for(let f=0;f<p;f++)Lt(x,g,c[f],c[f]);const v=le(c);for(let f=0;f<v.length;f+=3)s+=Xt(c[v[f]],c[v[f+1]],c[v[f+2]])}return F(s,a)}const se=I(),oe=I();function C(){return{positionsWorldCoords:[]}}function le(e){return Tt(re(e),[],2)}function re(e){const n=new Float64Array(2*e.length);for(let t=0;t<e.length;++t){const i=e[t],a=2*t;n[a]=i[0],n[a+1]=i[1]}return n}function ue(e){const{spatialReference:n}=e;return Mt(n,ce,fe,e)}function ce(e){return F(Math.abs(Ut([e],"square-meters")[0]),"square-meters")}function fe(e){try{return F(Math.abs(Ft(e,"square-meters")),"square-meters")}catch{return null}}function pe(e,n,t=C()){{const i=ue(e);return i??ie(e,t)}}function Re(e,n=C()){return pe(e,"on-the-ground",n)}export{Gt as B,Me as F,Ie as G,Nt as I,Ue as M,ke as R,Ae as T,Ve as U,xe as V,we as b,Fe as h,be as k,ye as r,Re as u,Le as x};
