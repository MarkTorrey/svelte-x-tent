const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./calcite-label-BdEQ_0Hz.js","./index-CaKGzNfV.js","./index-BvbKYc24.css","./calcite-button-EONkqF40.js"])))=>i.map(i=>d[i]);
import{mn as f,aw as I,Z as b,iM as $,a0 as T,mo as E,mp as k,Q as A,mq as S,W as i,X as r,Y as y,aN as O,ix as V,V as L,kh as U,ki as C,mr as M,_ as h,kj as o,ms as x}from"./index-CaKGzNfV.js";function D(t,e){const s=new f({enabled:!0,selfEnabled:!1,featureEnabled:!0,distance:e==null?void 0:e.distance,touchSensitivityMultiplier:(e==null?void 0:e.touchSensitivityMultiplier)??I.touchSensitivityMultiplier});return{...b(()=>{var n,p;return((p=(n=t.map)==null?void 0:n.allLayers)==null?void 0:p.toArray())??[]},n=>{s.featureSources=new T(n).map(p=>new E({layer:p}))},$),options:s}}const v=new Map;function R(t){if(!v.has(t)){const n=D(t,{distance:10}),p=P(t,n.options);v.set(t,{referenceCount:0,snappingManager:p,remove:()=>{n.remove(),p.destroy()}})}const e=v.get(t);e.referenceCount++;const s=A(()=>H(t,e));return{snappingManager:e.snappingManager,...s}}function H(t,e){e.referenceCount--,e.referenceCount>0||S(()=>{e.referenceCount===0&&(e.remove(),v.delete(t))})}function P(t,e){return new k({view:t,options:e})}let d=class extends O{constructor(e){super(e),this.tool=null,this._loggedUnsupportedErrorOnce=!1,(e==null?void 0:e.visible)!=null&&(this.visible=e.visible)}initialize(){this.addHandles(b(()=>({ready:this.view!=null&&this.view.ready,supported:this.supported}),({ready:e,supported:s})=>{!e||s||this._loggedUnsupportedErrorOnce||(this.logError(this.unsupportedErrorMessage),this._loggedUnsupportedErrorOnce=!0)},$))}destroy(){this.removeTool(),this.view=null}get active(){return this.tool!=null&&this.tool.active}get disabled(){return this.view==null||!this.view.ready||!this.supported}get supported(){return this.view==null||this.view.type===this.supportedViewType}get view(){return this._get("view")}set view(e){if(e===this.view)return;this.removeTool(),this._set("view",e);const s="tools";this.removeHandles(s),e!=null&&this.addHandles(e.tools.on("after-remove",n=>{n.item===this.tool&&this._set("tool",null)}),s)}set visible(e){this._set("visible",e),this.tool!=null&&(this.tool.visible=e)}createTool(e={interactive:!1}){if(this.removeTool(),this.view==null||!this.view.ready||!this.supported)return;const s=this.constructTool();s.created?(this._set("tool",s),this.view.tools.add(s)):e.interactive?(this._set("tool",s),this.view.addAndActivateTool(s),V(()=>s.created,()=>{s.active&&this.view!=null&&(this.view.activeTool=null)},{initial:!0,once:!0})):s.destroy()}removeTool(){var n;const e=this.tool;if(e==null)return;const s=(n=this.view)==null?void 0:n.tools;s!=null?s.remove(e):e.destroy(),this._set("tool",null)}logError(...e){L.getLogger(this).error(...e)}};i([r({constructOnly:!0})],d.prototype,"tool",void 0),i([r()],d.prototype,"active",null),i([r()],d.prototype,"disabled",null),i([r()],d.prototype,"supported",null),i([r({value:null})],d.prototype,"view",null),i([r({type:Boolean,value:!0})],d.prototype,"visible",null),d=i([y("esri.widgets.support.InteractiveToolViewModel")],d);const _="esri-unit-select",g={base:_,label:`${_}__label`,select:`${_}__select`};let c=class extends C{constructor(t,e){super(t,e),this._onSelectChange=s=>{this.onChange(s.target.value)}}loadDependencies(){return M({label:()=>h(()=>import("./calcite-label-BdEQ_0Hz.js"),__vite__mapDeps([0,1,2]),import.meta.url),option:()=>h(()=>import("./index-CaKGzNfV.js").then(t=>t.vv),__vite__mapDeps([1,2]),import.meta.url),select:()=>h(()=>import("./index-CaKGzNfV.js").then(t=>t.vu),__vite__mapDeps([1,2]),import.meta.url)})}render(){const{messages:t,options:e,selectLabel:s,value:n,_onSelectChange:p}=this;return o("div",{class:g.base,key:"units"},o("calcite-label",{class:g.label},s,o("calcite-select",{class:g.select,label:s,onCalciteSelectChange:p},e.map(m=>{var w;return o("calcite-option",{key:m,selected:m===n,value:m},x(m)?t.systems[m]:(w=t.units[m])==null?void 0:w.pluralCapitalized)}))))}};i([r()],c.prototype,"options",void 0),i([r()],c.prototype,"onChange",void 0),i([r()],c.prototype,"selectLabel",void 0),i([r()],c.prototype,"value",void 0),i([r(),U("esri/core/t9n/Units")],c.prototype,"messages",void 0),c=i([y("esri.widgets.support.UnitSelect")],c);const a="esri-measurement-widget-content",u={base:a,actions:`${a}__actions`,error:`${a}__error`,hint:`${a}__hint`,hintText:`${a}__hint-text`,panelError:`${a}__panel--error`,settings:`${a}__settings`,measurement:`${a}__measurement`,measurementItem:`${a}__measurement-item`,measurementItemDisabled:`${a}__measurement-item--disabled`,measurementItemTitle:`${a}__measurement-item__title`,measurementItemValue:`${a}__measurement-item__value`};let l=class extends C{constructor(t,e){super(t,e)}loadDependencies(){return M({button:()=>h(()=>import("./calcite-button-EONkqF40.js"),__vite__mapDeps([3,1,2]),import.meta.url)})}render(){return o("div",{class:u.base},this._renderContent())}_renderContent(){const{supported:t,active:e,state:s}=this;switch(s){case"disabled":case"ready":return t?e?this._renderHint():this._renderActions():this._renderUnsupportedMessage();case"measuring":case"measured":return[this._renderSettings(),this._renderMeasurement(),this._renderActions()]}}_renderUnsupportedMessage(){return o("section",{class:u.error,key:"unsupported"},o("p",null,this.messages.unsupported))}_renderHint(){const{messages:t}=this;return o("section",{class:u.hint,key:"hint"},o("p",{class:u.hintText},t.hint))}_renderSettings(){return o("div",{class:u.settings,key:"settings"},o(c,{options:this.unitOptions,selectLabel:this.messages.unit,value:this.unit,onChange:this.onUnitChange}))}_renderMeasurement(){return o("section",{class:u.measurement,key:"measurement"},this.measurementItems.map(t=>this._renderMeasurementItem(t)))}_renderMeasurementItem({key:t,title:e,value:s}){return o("div",{class:this.classes(u.measurementItem,s==null&&u.measurementItemDisabled),key:t},o("span",{class:u.measurementItemTitle},e),o("span",{"aria-live":"polite",class:u.measurementItemValue},s??this.messages.notApplicable))}_renderActions(){const{messages:t}=this;return o("div",{class:u.actions},o("calcite-button",{class:this.newMeasurementButtonClass,disabled:this.state==="disabled",onclick:this.onNewMeasurementClick},t.newMeasurement))}};i([r()],l.prototype,"active",void 0),i([r()],l.prototype,"measurementItems",void 0),i([r()],l.prototype,"messages",void 0),i([r()],l.prototype,"newMeasurementButtonClass",void 0),i([r()],l.prototype,"onNewMeasurementClick",void 0),i([r()],l.prototype,"onUnitChange",void 0),i([r()],l.prototype,"state",void 0),i([r()],l.prototype,"supported",void 0),i([r()],l.prototype,"unit",void 0),i([r()],l.prototype,"unitOptions",void 0),l=i([y("esri.widgets.support.MeasurementWidgetContent")],l);export{R as a,d as p,l as u};
