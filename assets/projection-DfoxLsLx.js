import{eC as g,eD as _,eE as j,eF as L,eG as R,eH as x,dN as v,eI as O,eJ as N,cB as B,eK as W,eL as b,dF as J,eM as Y,eN as q,eO as z,dd as S,dP as D,eP as H,dG as I,eQ as K,e1 as Q}from"./index-Cek7aMWl.js";import{a as C}from"./spatialReferenceEllipsoidUtils-DfobcDUq.js";import{u as G}from"./computeTranslationToOriginAndRotation-B1gLm2pX.js";import{t as V,o as U}from"./DoubleArray-UXJnwWGc.js";import{i as d,T as F}from"./BufferView-D7rTj7nO.js";import{f as X,l as $,e as k}from"./vec3-BZAVlszX.js";import{n as Z}from"./vec4-CB19uIrr.js";const lr="Projection may be possible after calling projection.load().";function ur(r,e,o,a){r.error(`Failed to project from (wkid:${e.wkid}) to (wkid:${o.wkid}).${a?" ":""}${a}`)}function Tr(r,e,o,a,t){return E(A.TO_PCPF,d.fromTypedArray(r),u.NORMAL,F.fromTypedArray(e),F.fromTypedArray(o),a,d.fromTypedArray(t))?t:null}function mr(r,e,o,a,t){return E(A.FROM_PCPF,d.fromTypedArray(r),u.NORMAL,F.fromTypedArray(e),F.fromTypedArray(o),a,d.fromTypedArray(t))?t:null}function pr(r,e,o){return g(r,e,0,o,C(e),0,r.length/3)?o:null}function Pr(r,e,o){return g(r,C(o),0,e,o,0,r.length/3)?e:null}function yr(r,e,o){return _(f,o),X(e,r,f),j(f)&&$(e,e),e}function Ar(r,e,o){return L(f,o),Z(e,r,f),j(f)&&$(e,e,4),e}function dr(r,e,o,a){const t=e===u.NORMAL;return w(r,e,o,(c,l)=>{const n=Math.cos(Q(c));l[0]=t?n:1/n,l[1]=1},a)}function Fr(r,e,o,a){const t=e===u.NORMAL;return w(r,e,o,(c,l)=>{const n=Math.cosh(-c/K.radius);l[0]=1,l[1]=t?n:1/n},a)}function w(r,e,o,a,t){const c=e===u.NORMAL?3:4,l=[0,0];for(let n=0,T=1;n<r.length;n+=c,T+=3){a(o[T],l);const i=r[n]*l[0],m=r[n+1]*l[1],s=r[n+2],P=1/Math.sqrt(i*i+m*m+s*s);t[n]=i*P,t[n+1]=m*P,t[n+2]=s*P,c===4&&(t[n+3]=r[n+3])}return t}function Nr(r,e,o,a,t){if(!E(A.TO_PCPF,d.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),u.TANGENT,F.fromTypedArray(e),F.fromTypedArray(o),a,d.fromTypedArray(t,4*Float32Array.BYTES_PER_ELEMENT)))return null;for(let c=3;c<r.length;c+=4)t[c]=r[c];return t}function Mr(r,e,o,a,t){if(!E(A.FROM_PCPF,d.fromTypedArray(r,16),u.TANGENT,F.fromTypedArray(e),F.fromTypedArray(o),a,d.fromTypedArray(t,16)))return null;for(let c=3;c<r.length;c+=4)t[c]=r[c];return t}var u,A;function h(r,e,o,a,t){switch(G(a,o,y,a),r===A.FROM_PCPF&&I(y,y),e){case u.NORMAL:return _(t,y);case u.TANGENT:return L(t,y)}}function E(r,e,o,a,t,c,l){if(!e)return;const n=a.count,T=C(c);if(or(c))for(let i=0;i<n;i++)t.getVec(i,M),e.getVec(i,p),R(p,p,h(r,o,M,T,f)),l.setVec(i,p);else for(let i=0;i<n;i++){t.getVec(i,M),e.getVec(i,p);const m=x(a.get(i,1));let s=Math.cos(m);o===u.TANGENT!=(r===A.TO_PCPF)&&(s=1/s),h(r,o,M,T,f),r===A.TO_PCPF?(f[0]*=s,f[1]*=s,f[2]*=s,f[3]*=s,f[4]*=s,f[5]*=s):(f[0]*=s,f[3]*=s,f[6]*=s,f[1]*=s,f[4]*=s,f[7]*=s),R(p,p,f),v(p,p),l.setVec(i,p)}return l}function gr(r){return r.vertexSpace.type==="local"?rr(r):er(r)}function rr({vertexSpace:r,transform:e,inSpatialReference:o,outSpatialReference:a,localMode:t,outPositions:c,positions:l}){const n=r.origin??O,T=r.origin!=null?(e==null?void 0:e.localMatrix)??N:N,i=C(o),m=a.isWebMercator&&t||!B(o,i)?o:i;G(o,n,y,m),W(y,y,T);const s=c??V(l.length);return k(s,l,y),g(s,m,0,s,a,0,s.length/3),s}function er({vertexSpace:r,transform:e,outPositions:o,positions:a,inSpatialReference:t,outSpatialReference:c}){const l=r.origin!=null?(e==null?void 0:e.localMatrix)??N:N,n=o??V(a.length);b(l,N)?U(n,a):k(n,a,l);const T=r.origin??O;if(!J(T,O)){const[i,m,s]=T;for(let P=0;P<n.length;P+=3)n[P]+=i,n[P+1]+=m,n[P+2]+=s}return g(n,t,0,n,c,0,n.length/3)?n:null}function or(r){return r.isWGS84||Y(r)||q(r)||z(r)}(function(r){r[r.NORMAL=0]="NORMAL",r[r.TANGENT=1]="TANGENT"})(u||(u={})),function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"}(A||(A={}));const M=S(),p=S(),y=D(),f=H();export{u as VectorType,lr as loadProjectErrorMessage,ur as logProjectionError,gr as project,Pr as projectFromPCPF,mr as projectNormalFromPCPF,Tr as projectNormalToPCPF,Mr as projectTangentFromPCPF,Nr as projectTangentToPCPF,pr as projectToPCPF,yr as transformNormal,Ar as transformTangent,dr as transformVectorENUPlateCarree,Fr as transformVectorWMPlateCarree};
