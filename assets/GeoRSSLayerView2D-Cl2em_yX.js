import{Y as l,Z as h,$ as g,a0 as f,V as w,X as d}from"./index-Cek7aMWl.js";import{t as u,p as n}from"./jsonUtils-DGzEHX8a.js";import{d as V}from"./FeatureSet-ClbNh9OS.js";import{f as b}from"./LayerView2D-BVUnvPSB.js";import{t as S}from"./GraphicContainer-Dde5PEzo.js";import{V as _}from"./GraphicsView2D-dxjiOMsf.js";import{y as T}from"./LayerView-Dyxjvlzf.js";import"./UniqueValueRenderer-DoQjGRE5.js";import"./ColorStop-CqMXhorb.js";import"./colorRamps-4yJNyWKx.js";import"./sizeVariableUtils-Cmcuvw-4.js";import"./visualVariableUtils-Cdb7Kq7r.js";import"./jsonUtils-C2l4B_cE.js";import"./defaults-fOuW8gwA.js";import"./defaultsJSON-GKolV7NZ.js";import"./styleUtils-Dv2EsbEO.js";import"./LRUCache-pAqnhOsq.js";import"./Version-DJsGRXWf.js";import"./FieldsIndex-Bjg3eA_S.js";import"./UnknownTimeZone-Cjv2gi-C.js";import"./OverrideHelper-ClkM4CZ1.js";import"./colorUtils-BlCLzs4t.js";import"./utils-BE8joJvK.js";import"./quantizationUtils-DeBnMDmu.js";import"./heatmapUtils-NTzr8GZp.js";import"./Container-BHyIqe9V.js";import"./EffectView-xdWvf2J0.js";import"./highlightReasons-B4N7T4kB.js";import"./definitions-Y_v3njP4.js";import"./enums-BlUEVwJR.js";import"./Texture-BjUzSnJr.js";import"./AGraphicContainer-DCIE21Ap.js";import"./TechniqueInstance-BfDw3KsI.js";import"./UpdateTracking2D-B5DpfoKL.js";import"./BindType-BmZEZMMh.js";import"./Util-D3WFoRjI.js";import"./Program-DDsdwrVN.js";import"./BufferObject-Dtd0vzOu.js";import"./LabelMetric-BX4Cxpgy.js";import"./enums-BRXbslMp.js";import"./VertexElementDescriptor-BOD-G50G.js";import"./BoundingBox-DD1zHGe8.js";import"./TileContainer-CeQi5mdh.js";import"./WGLContainer-BWXDcjjt.js";import"./VertexArrayObject-DSiuLT7k.js";import"./vec4f32-CjrfB-0a.js";import"./ProgramTemplate-CwsURtYf.js";import"./vec3f32-nZdmKIgz.js";import"./StyleDefinition-BK3ROBTO.js";import"./config-MDUrh2eL.js";import"./earcut-DbRqQWyy.js";import"./featureConversionUtils-DoC7B3A2.js";import"./OptimizedFeature-7juV2tZm.js";import"./OptimizedGeometry-vU5jWBvU.js";import"./OptimizedFeatureSet-Blu9Ckm7.js";import"./FeatureCommandQueue-D8t0EUoQ.js";import"./CIMSymbolHelper-CY__-kW6.js";import"./BidiEngine-BwB1Df7c.js";import"./fontUtils-DnX1oK2e.js";import"./GeometryUtils-B2Qq2Dwi.js";import"./Rect-CUzevAry.js";import"./constants-D5zmR9t2.js";import"./AttributeStore-BqZyTXj5.js";import"./labelUtils-C4iNx9oT.js";import"./TimeOnly-BJnd6TEv.js";import"./centroid-DdLmOD72.js";import"./timeSupport-4nmKr68x.js";import"./json-Wa8cmqdu.js";import"./normalizeUtilsSync-BuSxwAtS.js";let y=class extends b(T){constructor(){super(...arguments),this._graphicsViewMap={},this._popupTemplates=new Map,this.graphicsViews=[]}async hitTest(t,o){if(!this.graphicsViews.length)return null;const e=this.layer;return this.graphicsViews.reverse().flatMap(r=>{const i=this._popupTemplates.get(r),s=r.hitTest(t);for(const p of s)p.layer=e,p.sourceLayer=e,p.popupTemplate=i;return s}).map(r=>({type:"graphic",graphic:r,layer:e,mapPoint:t}))}update(t){if(this.graphicsViews)for(const o of this.graphicsViews)o.processUpdate(t)}attach(){this.addAttachHandles([l(()=>{var t;return(t=this.layer)==null?void 0:t.featureCollections},t=>{this._clear();for(const{popupInfo:o,featureSet:e,layerDefinition:r}of t){const i=V.fromJSON(e),s=new g(i.features),p=r.drawingInfo,c=o?f.fromJSON(o):null,m=u(p.renderer),a=new _({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:s,renderer:m,container:new S(this.view.featuresTilingScheme)});this._graphicsViewMap[i.geometryType]=a,this._popupTemplates.set(a,c),i.geometryType!=="polygon"||this.layer.polygonSymbol?i.geometryType!=="polyline"||this.layer.lineSymbol?i.geometryType!=="point"||this.layer.pointSymbol||(this.layer.pointSymbol=m.symbol):this.layer.lineSymbol=m.symbol:this.layer.polygonSymbol=m.symbol,this.graphicsViews.push(a),this.container.addChild(a.container)}},h),l(()=>{var t;return(t=this.layer)==null?void 0:t.polygonSymbol},t=>{this._graphicsViewMap.polygon.renderer=new n({symbol:t})},h),l(()=>{var t;return(t=this.layer)==null?void 0:t.lineSymbol},t=>{this._graphicsViewMap.polyline.renderer=new n({symbol:t})},h),l(()=>{var t;return(t=this.layer)==null?void 0:t.pointSymbol},t=>{this._graphicsViewMap.point.renderer=new n({symbol:t})},h)])}detach(){this._clear()}moveEnd(){}viewChange(){for(const t of this.graphicsViews)t.viewChange()}_clear(){this.container.removeAllChildren();for(const t of this.graphicsViews)t.destroy();this._graphicsViewMap={},this._popupTemplates.clear(),this.graphicsViews.length=0}};y=w([d("esri.views.2d.layers.GeoRSSLayerView2D")],y);const Pt=y;export{Pt as default};
