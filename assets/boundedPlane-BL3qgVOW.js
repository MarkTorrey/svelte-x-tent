import{de as A,df as S,dg as z,dh as O,di as rn,dj as u,dk as an,dl as F,dm as f,dn as r,dp as l,dq as P,dr as cn,ds as un,dt as gn,du as m,dv as bn,dw as dn,dx as fn,dy as h,dz as ln,dA as pn,dB as R,dC as $n,dD as B,dE as N,dF as E,dG as hn,dH as mn,dI as $,dJ as M,dK as In,dL as Pn,dM as V,dN as J,dO as k,dd as v,dP as H,U as Nn}from"./index-Cek7aMWl.js";import{v as vn,A as D,j as Mn}from"./lineSegment-CMQTKrER.js";const _=()=>Nn.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");class wn{constructor(){this.plane=A(),this.origin=v(),this.basis1=v(),this.basis2=v()}}const An=wn;function I(n=on){return{plane:A(n.plane),origin:O(n.origin),basis1:O(n.basis1),basis2:O(n.basis2)}}function Tn(n,i,s){const t=Cn.get();return t.origin=n,t.basis1=i,t.basis2=s,t.plane=rn(0,0,0,0),x(t),t}function T(n,i=I()){return K(n.origin,n.basis1,n.basis2,i)}function xn(n,i){u(i.origin,n.origin),u(i.basis1,n.basis1),u(i.basis2,n.basis2),an(i.plane,n.plane)}function K(n,i,s,t=I()){return u(t.origin,n),u(t.basis1,i),u(t.basis2,s),x(t),Yn(t,"fromValues()"),t}function x(n){F(n.basis2,n.basis1,n.origin,n.plane)}function W(n,i,s){n!==s&&T(n,s);const t=f(r.get(),d(n),i);return l(s.origin,s.origin,t),s.plane[3]-=i,s}function yn(n,i,s){return X(i,s),W(s,q(n,n.origin),s),s}function X(n,i=I()){const s=(n[2]-n[0])/2,t=(n[3]-n[1])/2;return P(i.origin,n[0]+s,n[1]+t,0),P(i.basis1,s,0,0),P(i.basis2,0,t,0),cn(0,0,1,0,i.plane),i}function U(n,i,s){return!!un(n.plane,i,s)&&tn(n,s)}function Sn(n,i,s){if(U(n,i,s))return s;const t=Z(n,i,r.get());return l(s,i.origin,f(r.get(),i.direction,gn(i.origin,t)/m(i.direction))),s}function Z(n,i,s){const t=w.get();en(n,i,t,w.get());let e=Number.POSITIVE_INFINITY;for(const o of G){const a=C(n,o,y.get()),g=r.get();if(bn(t,a,g)){const c=dn(r.get(),i.origin,g),b=Math.abs(fn(h(i.direction,c)));b<e&&(e=b,u(s,g))}}return e===Number.POSITIVE_INFINITY?Q(n,i,s):s}function Q(n,i,s){if(U(n,i,s))return s;const t=w.get(),e=w.get();en(n,i,t,e);let o=Number.POSITIVE_INFINITY;for(const a of G){const g=C(n,a,y.get()),c=r.get();if(ln(t,g,c)){const b=pn(i,c);if(!R(e,c))continue;b<o&&(o=b,u(s,c))}}return Y(n,i.origin)<o&&nn(n,i.origin,s),s}function nn(n,i,s){const t=$n(n.plane,i,r.get()),e=D(L(n,n.basis1),t,-1,1,r.get()),o=D(L(n,n.basis2),t,-1,1,r.get());return B(s,l(r.get(),e,o),n.origin),s}function sn(n,i,s){const{origin:t,basis1:e,basis2:o}=n,a=B(r.get(),i,t),g=N(e,a),c=N(o,a),b=N(d(n),a);return P(s,g,c,b)}function Y(n,i){const s=sn(n,i,r.get()),{basis1:t,basis2:e}=n,o=m(t),a=m(e),g=Math.max(Math.abs(s[0])-o,0),c=Math.max(Math.abs(s[1])-a,0),b=s[2];return g*g+c*c+b*b}function On(n,i){return Math.sqrt(Y(n,i))}function En(n,i){let s=Number.NEGATIVE_INFINITY;for(const t of G){const e=C(n,t,y.get()),o=Mn(e,i);o>s&&(s=o)}return Math.sqrt(s)}function Vn(n,i){return R(n.plane,i)&&tn(n,i)}function _n(n,i,s,t){return Un(n,s,t)}function q(n,i){const s=-n.plane[3];return N(d(n),i)-s}function jn(n,i,s,t){const e=q(n,i),o=f(qn,d(n),s-e);return l(t,i,o),t}function Fn(n,i){return E(n.basis1,i.basis1)&&E(n.basis2,i.basis2)&&E(n.origin,i.origin)}function zn(n,i,s){return n!==s&&T(n,s),hn(p,i),mn(p,p),$(s.basis1,n.basis1,p),$(s.basis2,n.basis2,p),$(M(s.plane),M(n.plane),p),$(s.origin,n.origin,i),In(s.plane,s.plane,s.origin),s}function Bn(n,i,s,t){return n!==t&&T(n,t),Pn(j,i,s),$(t.basis1,n.basis1,j),$(t.basis2,n.basis2,j),x(t),t}function d(n){return M(n.plane)}function Un(n,i,s){switch(i){case V.X:u(s,n.basis1),J(s,s);break;case V.Y:u(s,n.basis2),J(s,s);break;case V.Z:u(s,d(n))}return s}function tn(n,i){const s=B(r.get(),i,n.origin),t=k(n.basis1),e=k(n.basis2),o=h(n.basis1,s),a=h(n.basis2,s);return-o-t<0&&o-t<0&&-a-e<0&&a-e<0}function L(n,i){const s=y.get();return u(s.origin,n.origin),u(s.vector,i),s}function C(n,i,s){const{basis1:t,basis2:e,origin:o}=n,a=f(r.get(),t,i.origin[0]),g=f(r.get(),e,i.origin[1]);l(s.origin,a,g),l(s.origin,s.origin,o);const c=f(r.get(),t,i.direction[0]),b=f(r.get(),e,i.direction[1]);return f(s.vector,l(c,c,b),2),s}function Yn(n,i){Math.abs(h(n.basis1,n.basis2)/(m(n.basis1)*m(n.basis2)))>1e-6&&_().warn(i,"Provided basis vectors are not perpendicular"),Math.abs(h(n.basis1,d(n)))>1e-6&&_().warn(i,"Basis vectors and plane normal are not perpendicular"),Math.abs(-h(d(n),n.origin)-n.plane[3])>1e-6&&_().warn(i,"Plane offset is not consistent with plane origin")}function en(n,i,s,t){const e=d(n);F(e,i.direction,i.origin,s),F(M(s),e,i.origin,t)}const on={plane:A(),origin:S(0,0,0),basis1:S(1,0,0),basis2:S(0,1,0)},w=new z(A),y=new z(vn),qn=v(),Cn=new z(()=>I()),G=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],p=H(),j=H();Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:An,altitudeAt:q,axisAt:_n,closestPoint:Q,closestPointOnSilhouette:Z,copy:T,copyWithoutVerify:xn,create:I,distance:On,distance2:Y,distanceToSilhouette:En,elevate:W,equals:Fn,extrusionContainsPoint:Vn,fromAABoundingRect:X,fromValues:K,intersectRay:U,intersectRayClosestSilhouette:Sn,normal:d,projectPoint:nn,projectPointLocal:sn,rotate:Bn,setAltitudeAt:jn,setExtent:yn,transform:zn,up:on,updateUnboundedPlane:x,wrap:Tn},Symbol.toStringTag,{value:"Module"}));export{X as $,x as J,I as W,T as Z,On as a};
