import{mH as R,k1 as $,iH as E,kM as F,mI as v,is as O,mJ as A,az as y,gd as S,iF as I}from"./index-CaKGzNfV.js";import{p as U,e as w,t as N}from"./Geometry-B3hX0nD2.js";import{A as C}from"./Indices-tTCnngdH.js";import{t as f}from"./orientedBoundingBox-x0xgCGoZ.js";import{e as u}from"./VertexAttribute-Cq4MnHjR.js";import{p as g,a as D}from"./triangulationUtils-DijgMkGR.js";import{u as L}from"./RibbonLine.glsl-Dg0oXIM0.js";import{r as H}from"./ColorMaterial-CQszLCQN.js";import{H as m}from"./InterleavedLayout-4ahhYnBx.js";var T;(function(t){t[t.EnableFastUpdates=0]="EnableFastUpdates",t[t.DisableFastUpdates=1]="DisableFastUpdates",t[t.UpdateFastLocalOrigin=2]="UpdateFastLocalOrigin"})(T||(T={}));const i={dash:[4,3],dot:[1,3],"long-dash":[8,3],"short-dash":[4,1],"short-dot":[1,1]},P={dash:i.dash,"dash-dot":[...i.dash,...i.dot],dot:i.dot,"long-dash":i["long-dash"],"long-dash-dot":[...i["long-dash"],...i.dot],"long-dash-dot-dot":[...i["long-dash"],...i.dot,...i.dot],none:null,"short-dash":i["short-dash"],"short-dash-dot":[...i["short-dash"],...i["short-dot"]],"short-dash-dot-dot":[...i["short-dash"],...i["short-dot"],...i["short-dot"]],"short-dot":i["short-dot"],solid:null},z=8;function j(t,n){return t==null?t:{pattern:t.slice(),pixelRatio:n}}function rt(t){return{pattern:[t,t],pixelRatio:2}}function it(t){return(t==null?void 0:t.type)==="style"?x(t.style):null}function x(t){return t!=null?j(P[t],z):null}function lt(t,n,o=null){const a=[],r=n.mapPositions;B(n,a);const l=a[0][1].data,s=a[0][1].indices.length,e=C(s);return _(n,a,e),Z(n,a,e),G(n,a,e),M(n,a,e),k(n,a,e),J(n,a,e),V(n,a,l),new U(t,a,r,w.Line,o)}function B(t,n){const{attributeData:{position:o},removeDuplicateStartEnd:a}=t,r=W(o)&&a,l=o.length/3-(r?1:0),s=new Array(2*(l-1)),e=r?o.slice(0,-3):o;let c=0;for(let p=0;p<l-1;p++)s[c++]=p,s[c++]=p+1;n.push([u.POSITION,new f(e,s,3,r)])}function _(t,n,o){if(t.attributeData.colorFeature!=null)return;const a=t.attributeData.color;n.push([u.COLOR,new f(a??R,o,4)])}function G(t,n,o){t.attributeData.normal&&n.push([u.NORMAL,new f(t.attributeData.normal,o,3)])}function M(t,n,o){t.attributeData.colorFeature!=null&&n.push([u.COLORFEATUREATTRIBUTE,new f([t.attributeData.colorFeature],o,1,!0)])}function Z(t,n,o){t.attributeData.sizeFeature==null&&n.push([u.SIZE,new f([t.attributeData.size??1],o,1,!0)])}function k(t,n,o){t.attributeData.sizeFeature!=null&&n.push([u.SIZEFEATUREATTRIBUTE,new f([t.attributeData.sizeFeature],o,1,!0)])}function J(t,n,o){t.attributeData.opacityFeature!=null&&n.push([u.OPACITYFEATUREATTRIBUTE,new f([t.attributeData.opacityFeature],o,1,!0)])}function V(t,n,o){if(t.overlayInfo==null||t.overlayInfo.renderCoordsHelper.viewingMode!==$.Global||!t.overlayInfo.spatialReference.isGeographic)return;const a=E(o.length),r=F(t.overlayInfo.spatialReference);for(let h=0;h<a.length;h+=3)v(o,h,a,h,r);const l=o.length/3,s=N(l+1);let e=Y,c=q,p=0,d=0;O(e,a[d++],a[d++]),d++,s[0]=0;for(let h=1;h<l+1;++h)h===l&&(d=0),O(c,a[d++],a[d++]),d++,p+=A(e,c),s[h]=p,[e,c]=[c,e];n.push([u.DISTANCETOSTART,new f(s,n[0][1].indices,1,!0)])}function W(t){const n=t.length;return t[0]===t[n-3]&&t[1]===t[n-2]&&t[2]===t[n-1]}const Y=y(),q=y();function ut(t,n,o,a){const r=t.type==="polygon"?g.CCW_IS_HOLE:g.NONE,l=t.type==="polygon"?t.rings:t.paths,{position:s,outlines:e}=D(l,!!t.hasZ,r,t.spatialReference),c=E(s.length),p=L(s,t.spatialReference,0,c,0,s,0,s.length/3,n,o,a),d=p!=null;return{lines:d?b(e,s,c):[],projectionSuccess:d,sampledElevation:p}}function ct(t,n){const o=t.type==="polygon"?g.CCW_IS_HOLE:g.NONE,a=t.type==="polygon"?t.rings:t.paths,{position:r,outlines:l}=D(a,!1,o),s=S(r,t.spatialReference,0,r,n,0);for(let e=2;e<r.length;e+=3)r[e]=H;return{lines:s?b(l,r):[],projectionSuccess:s}}function b(t,n,o=null){const a=new Array;for(const{index:r,count:l}of t){if(l<=1)continue;const s=3*r,e=3*l;a.push({position:I(n,3*r,3*l),mapPositions:o!=null?I(o,s,e):void 0})}return a}const pt=m().vec3f(u.POSITION),dt=m().vec3f(u.POSITION).vec2f(u.UV0),ht=m().vec3f(u.POSITION).vec4u8(u.COLOR),ft=m().vec3f(u.POSITION).vec2f(u.UV0).vec4u8(u.OBJECTANDLAYERIDCOLOR);export{ft as I,T as a,lt as b,dt as f,rt as h,ct as l,it as n,ut as p,ht as r,pt as t};
