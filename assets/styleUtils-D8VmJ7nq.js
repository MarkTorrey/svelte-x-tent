import{B as m,de as d,b$ as b,b_ as p,i8 as h,bJ as w,dq as U,cm as $}from"./index-BdDnxAOC.js";const f=new Map;async function N(e,s){try{return{data:(await g(e,s)).data,baseUrl:d(e),styleUrl:e}}catch(t){return b(t),null}}function R(e,s,t){var c;const n=s.portal!=null?s.portal:p.getDefault();let r;const l=`${n.url} - ${(c=n.user)==null?void 0:c.username} - ${e}`,u=f.get(l);if(u)return u;const o=I(e,n,t).then(a=>(r=a,a.fetchData())).then(a=>({data:a,baseUrl:r.itemUrl??"",styleName:e}));return f.set(l,o),o}function I(e,s,t){return s.load(t).then(()=>{const n=new h({disableExtraQuery:!0,query:`owner:${y} AND type:${i} AND typekeywords:"${e}"`});return s.queryItems(n,t)}).then(({results:n})=>{var u;let r=null;const l=e.toLowerCase();if(n&&Array.isArray(n)){for(const o of n)if(((u=o.typeKeywords)==null?void 0:u.some(a=>a.toLowerCase()===l))&&o.type===i&&o.owner===y){r=o;break}}if(!r)throw new m("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return r.load(t)})}function q(e,s,t){return(e==null?void 0:e.styleUrl)!=null?N(e.styleUrl,t):(e==null?void 0:e.styleName)!=null?R(e.styleName,s,t):Promise.reject(new m("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function A(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function C(e,s,t=["gltf"]){if(s==="cimRef")return encodeURI(e.cimRef);if(e.formatInfos&&!$("enable-feature:force-wosr"))for(const n of t){const r=e.formatInfos.find(l=>l.type===n);if(r)return r.href}return encodeURI(e.webRef)}function g(e,s){const t={responseType:"json",query:{f:"json"},...s};return w(U(e),t)}const y="esri_en",i="Style",D="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";export{D as h,q as i,A as m,g as p,C as y};
